# FreeBSD$
# Javad Kouhi <javad.kouhi@gmail.com>, 2020.
# Faraz Vahedi <kfv@irbug.org>, 2020.
# Parsa Samet <qps@irbug.org>, 2020.
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2020-06-06 11:08-0300\n"
"PO-Revision-Date: 2020-05-09 12:58+0000\n"
"Last-Translator: Parsa Samet <qps@irbug.org>\n"
"Language-Team: Persian <https://translate-dev.freebsd.org/projects/freebsd-"
"doc/articles_ipsec-must/fa/>\n"
"Language: fa\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=2; plural=n > 1;\n"
"X-Generator: Weblate 3.11.3\n"

#. Put one translator per line, in the form NAME <EMAIL>, YEAR1, YEAR2
msgctxt "_"
msgid "translator-credits"
msgstr "جواد کوهی <javad@kouhi.org>، سال ۲۰۲۰"

#. (itstool) path: info/title
#: article.translate.xml:9
msgid "Independent Verification of IPsec Functionality in FreeBSD"
msgstr "تصدیق عملکرد IPsec به طور مستقل در FreeBSD"

#. (itstool) path: affiliation/address
#: article.translate.xml:13
#, no-wrap
msgid "<email>honig@sprynet.com</email>"
msgstr "<email>honig@sprynet.com</email>"

#. (itstool) path: info/author
#: article.translate.xml:12
msgid ""
"<personname><firstname>David</firstname><surname>Honig</surname></"
"personname><affiliation> <_:address-1/> </affiliation>"
msgstr ""
"<personname><firstname>دیوید</firstname><surname>هانیگ</surname></"
"personname><affiliation> <_:address-1/> </affiliation>"

#. (itstool) path: info/pubdate
#: article.translate.xml:16
msgid "1999-05-03"
msgstr "1999-05-03"

#. (itstool) path: legalnotice/para
#: article.translate.xml:19
msgid "FreeBSD is a registered trademark of the FreeBSD Foundation."
msgstr "FreeBSD یک نشان تجاری ثبت شده متعلق به FreeBSD Foundation است."

#. (itstool) path: legalnotice/para
#: article.translate.xml:21
msgid ""
"Motif, OSF/1, and UNIX are registered trademarks and IT DialTone and The "
"Open Group are trademarks of The Open Group in the United States and other "
"countries."
msgstr ""
"Motif، OSF/1 و UNIX نشان‌های تجاری ثبت شده و IT DialTone و The Open Group "
"نشان‌های تجاری متعلق به کنسرسیوم The Open Group در ایالات متحده و دیگر کشورها "
"هستند."

#. (itstool) path: legalnotice/para
#: article.translate.xml:25
msgid ""
"Many of the designations used by manufacturers and sellers to distinguish "
"their products are claimed as trademarks. Where those designations appear in "
"this document, and the FreeBSD Project was aware of the trademark claim, the "
"designations have been followed by the <quote>™</quote> or the <quote>®</"
"quote> symbol."
msgstr ""
"بسیاری از عناوین مورد استفاده توسط تولیدکنندگان و فروشندگان برای مشخص کردن "
"محصولاتشان به عنوان نشان‌های تجاری اظهار شده‌اند. در هر جای این سند که این "
"عناوین ذکر شده باشند، در صورتی که پروژه FreeBSD از اظهارنامه آن نشان تجاری "
"آگاه باشد، همراه عنوان علامت <quote>™</quote> یا <quote>®</quote> آمده است."

#. (itstool) path: info/releaseinfo
#: article.translate.xml:33
msgid ""
"$FreeBSD: head/en_US.ISO8859-1/articles/ipsec-must/article.xml 52227 "
"2018-09-06 01:30:47Z ebrandi $"
msgstr ""
"$FreeBSD: head/en_US.ISO8859-1/articles/ipsec-must/article.xml 52227 "
"2018-09-06 01:30:47Z ebrandi $"

#. (itstool) path: abstract/para
#: article.translate.xml:36
msgid ""
"You installed IPsec and it seems to be working. How do you know? I describe "
"a method for experimentally verifying that IPsec is working."
msgstr ""
"IPsec را نصب کرده‌اید و به نظر می‌رسد که کار هم می‌کند. ولی از کجا می‌دانید؟ من "
"روشی را در اینجا تشریح می‌کنم که با آن می‌توانید به طور آزمون‌گرانه تصدیق کنید "
"که IPsec به درستی کار می‌کند."

#. (itstool) path: sect1/title
#: article.translate.xml:43
msgid "The Problem"
msgstr "تعریف مشکل"

#. (itstool) path: sect1/para
#: article.translate.xml:45
msgid ""
"First, lets assume you have <link linkend=\"ipsec-install\"> installed "
"<emphasis>IPsec</emphasis></link>. How do you know it is <link linkend="
"\"caveat\">working</link>? Sure, your connection will not work if it is "
"misconfigured, and it will work when you finally get it right. "
"<citerefentry><refentrytitle>netstat</refentrytitle><manvolnum>1</"
"manvolnum></citerefentry> will list it. But can you independently confirm it?"
msgstr ""
"ابتدا، بیایید فرض کنیم که شما <link linkend=\"ipsec-install"
"\"><emphasis>IPsec</emphasis> را نصب کرده‌اید</link>. از کجا می‌دانید که به "
"درستی <link linkend=\"caveat\">کار می‌کند</link>؟ بله، درست است، اگر به درستی "
"پیکربندی نشده بود اتصال شما کار نمی‌کرد، فقط وقتی آن را درست پیکربندی کرده "
"باشید کار خواهد کرد. <citerefentry><refentrytitle>netstat</"
"refentrytitle><manvolnum>1</manvolnum></citerefentry> آن را فهرست خواهد کرد. "
"ولی آیا به طور مستقل هم می‌توانید آن را تصدیق کنید؟"

#. (itstool) path: sect1/title
#: article.translate.xml:54
msgid "The Solution"
msgstr "راه حل"

#. (itstool) path: sect1/para
#: article.translate.xml:56
msgid "First, some crypto-relevant info theory:"
msgstr "ابتدا، کمی اطلاعات تئوری در رابطه با رمزنگاری:"

#. (itstool) path: listitem/para
#: article.translate.xml:60
msgid ""
"Encrypted data is uniformly distributed, i.e., has maximal entropy per "
"symbol;"
msgstr ""
"داده‌های رمزنگاری‌شده به طور یکنواخت توزیع می‌شوند. به عبارت دیگر، به ازای هر "
"نماد، آنتروپی بیشینه دارند؛"

#. (itstool) path: listitem/para
#: article.translate.xml:65
msgid ""
"Raw, uncompressed data is typically redundant, i.e., has sub-maximal entropy."
msgstr ""
"داده‌های خام و فشرده‌ نشده عموما افزونگی دارند. به عبارت دیگر، آنتروپی فرو-"
"بیشینه دارند."

#. (itstool) path: sect1/para
#: article.translate.xml:70
msgid ""
"Suppose you could measure the entropy of the data to- and from- your network "
"interface. Then you could see the difference between unencrypted data and "
"encrypted data. This would be true even if some of the data in "
"<quote>encrypted mode</quote> was not encrypted---as the outermost IP header "
"must be if the packet is to be routable."
msgstr ""
"فرض کنید که می‌توانستید آنتروپی داده‌های ارسالی به کارت شبکه و دریافتی از آن "
"را اندازه‌گیری کنید. آنگاه می‌توانستید تفاوت بین داده‌های رمزنگاری‌شده و "
"رمزنگاری‌نشده را ببینید. این گفته حتی وقتی که مقداری از داده‌ها در <quote>حالت "
"رمزنگاری</quote> عملا رمزنگاری‌نشده باشند هم درست است. مثلا اگر قرار باشد "
"بسته قابل مسیریابی باشد، آنگاه بیرونی‌ترین سرایند IP نباید رمزنگاری‌شده باشد."

#. (itstool) path: sect2/title
#: article.translate.xml:78
msgid "MUST"
msgstr "MUST"

#. (itstool) path: sect2/para
#: article.translate.xml:80
msgid ""
"Ueli Maurer's <quote>Universal Statistical Test for Random Bit Generators</"
"quote>(<link xlink:href=\"https://web.archive.org/web/20011115002319/http://"
"www.geocities.com/SiliconValley/Code/4704/universal.pdf\"> <acronym>MUST</"
"acronym></link>) quickly measures the entropy of a sample. It uses a "
"compression-like algorithm. <link linkend=\"code\">The code is given below</"
"link> for a variant which measures successive (~quarter megabyte) chunks of "
"a file."
msgstr ""
"ابزار <quote>Universal Statistical Test for Random Bit Generators</"
"quote>(<link xlink:href=\"https://web.archive.org/web/20011115002319/http://"
"www.geocities.com/SiliconValley/Code/4704/universal.pdf\"> <acronym>MUST</"
"acronym></link>) یولی مائورر می‌تواند آنتروپی یک نمونه را به سرعت اندازه‌گیری "
"کند. این ابزار از یک الگوریتم شبه-فشرده‌سازی استفاده می‌کند. کد گونه‌ای از این "
"ابزار که قادر است به طور پیاپی (تقریبا یک چارک مگابایت) قطعات یک پرونده را "
"اندازه‌گیری کند، <link linkend=\"code\"> در زیر آورده شده است</link>."

#. (itstool) path: sect2/title
#: article.translate.xml:89
msgid "Tcpdump"
msgstr "Tcpdump"

#. (itstool) path: sect2/para
#: article.translate.xml:91
msgid ""
"We also need a way to capture the raw network data. A program called "
"<citerefentry><refentrytitle>tcpdump</refentrytitle><manvolnum>1</"
"manvolnum></citerefentry> lets you do this, if you have enabled the "
"<emphasis>Berkeley Packet Filter</emphasis> interface in your <link linkend="
"\"kernel\">kernel's config file</link>."
msgstr ""
"ما همچنین به روشی نیاز داریم تا بتوانیم داده‌های خام شبکه را ضبط کنیم. "
"برنامه‌ای به نام <citerefentry><refentrytitle>tcpdump</"
"refentrytitle><manvolnum>1</manvolnum></citerefentry> اجازه انجام چنین کاری "
"را به ما می‌دهد. برای استفاده از آن نیاز است تا در <link linkend=\"kernel"
"\">پرونده پیکربندی هسته</link> <emphasis>Berkeley Packet Filter</emphasis> "
"را فعال کرده باشید."

#. (itstool) path: sect2/para
#: article.translate.xml:97
msgid "The command:"
msgstr "دستور:"

#. (itstool) path: sect2/screen
#: article.translate.xml:99
#, no-wrap
msgid "<userinput>tcpdump -c 4000 -s 10000 -w <replaceable>dumpfile.bin</replaceable></userinput>"
msgstr "<userinput>tcpdump -c 4000 -s 10000 -w <replaceable>dumpfile.bin</replaceable></userinput>"

#. (itstool) path: sect2/para
#: article.translate.xml:101
msgid ""
"will capture 4000 raw packets to <replaceable>dumpfile.bin</replaceable>. Up "
"to 10,000 bytes per packet will be captured in this example."
msgstr ""
"۴۰۰۰ بسته خام را ضبط کرده و در <replaceable>dumpfile.bin</replaceable> ذخیره "
"می‌کند. در این مثال، تا ۱۰٬۰۰۰ بایت در هر بسته ضبط خواهد شد."

#. (itstool) path: sect1/title
#: article.translate.xml:108
msgid "The Experiment"
msgstr "آزمایش"

#. (itstool) path: sect1/para
#: article.translate.xml:110
msgid "Here is the experiment:"
msgstr "آزمایش از این قرار است:"

#. (itstool) path: step/para
#: article.translate.xml:114
msgid "Open a window to an IPsec host and another window to an insecure host."
msgstr ""
"یک پنجره به یک میزبانِ IPsec و پنجره‌ای دیگر به یک میزبان ناامن باز کنید."

#. (itstool) path: step/para
#: article.translate.xml:119
msgid "Now start <link linkend=\"tcpdump\">capturing packets</link>."
msgstr "حالا شروع به <link linkend=\"tcpdump\">ضبط بسته‌ها</link> نمایید."

#. (itstool) path: step/para
#: article.translate.xml:124
msgid ""
"In the <quote>secure</quote> window, run the <trademark class=\"registered"
"\">UNIX</trademark> command <citerefentry><refentrytitle>yes</"
"refentrytitle><manvolnum>1</manvolnum></citerefentry>, which will stream the "
"<literal>y</literal> character. After a while, stop this. Switch to the "
"insecure window, and repeat. After a while, stop."
msgstr ""
"حال در پنجره <quote>امن</quote>، دستور <trademark class=\"registered"
"\">یونیکسی</trademark> <citerefentry><refentrytitle>yes</"
"refentrytitle><manvolnum>1</manvolnum></citerefentry> را اجرا کنید، که باعث "
"خواهد شد کاراکتر <literal>y</literal> مثل یک جویبار روان شود. پس از مدتی، "
"این دستور را متوقف کنید. به پنجره ناامن بروید و همین کار را تکرار کنید. پس "
"از مدتی، آن را هم متوقف کنید."

#. (itstool) path: step/para
#: article.translate.xml:131
msgid ""
"Now run <link linkend=\"code\">MUST</link> on the captured packets. You "
"should see something like the following. The important thing to note is that "
"the secure connection has 93% (6.7) of the expected value (7.18), and the "
"<quote>normal</quote> connection has 29% (2.1) of the expected value."
msgstr ""
"حال <link linkend=\"code\">MUST</link> را روی بسته‌های ضبط شده اجرا کنید. "
"باید چیزی شبیه خروجی زیر را ببینید. نکته مهم این است که اتصال امن ۹۳٪ (۶.۷) "
"از مقدار مورد انتظار (۷.۱۸) را دارد، و اتصال <quote>عادی</quote> تنها ۲۹٪ "
"(۲.۱) از مقدار مورد انتظار را دارد."

#. (itstool) path: step/screen
#: article.translate.xml:138
#, no-wrap
msgid ""
"<prompt>%</prompt> <userinput>tcpdump -c 4000 -s 10000 -w <replaceable>ipsecdemo.bin</replaceable></userinput>\n"
"<prompt>%</prompt> <userinput>uliscan <replaceable>ipsecdemo.bin</replaceable></userinput>\n"
"\n"
"Uliscan 21 Dec 98\n"
"L=8 256 258560\n"
"Measuring file ipsecdemo.bin\n"
"Init done\n"
"Expected value for L=8 is 7.1836656\n"
"6.9396 --------------------------------------------------------\n"
"6.6177 -----------------------------------------------------\n"
"6.4100 ---------------------------------------------------\n"
"2.1101 -----------------\n"
"2.0838 -----------------\n"
"2.0983 -----------------"
msgstr ""
"<prompt>%</prompt> <userinput>tcpdump -c 4000 -s 10000 -w <replaceable>ipsecdemo.bin</replaceable></userinput>\n"
"<prompt>%</prompt> <userinput>uliscan <replaceable>ipsecdemo.bin</replaceable></userinput>\n"
"\n"
"Uliscan 21 Dec 98\n"
"L=8 256 258560\n"
"Measuring file ipsecdemo.bin\n"
"Init done\n"
"Expected value for L=8 is 7.1836656\n"
"6.9396 --------------------------------------------------------\n"
"6.6177 -----------------------------------------------------\n"
"6.4100 ---------------------------------------------------\n"
"2.1101 -----------------\n"
"2.0838 -----------------\n"
"2.0983 -----------------"

#. (itstool) path: sect1/title
#: article.translate.xml:157
msgid "Caveat"
msgstr "هشدار"

#. (itstool) path: sect1/para
#: article.translate.xml:159
msgid ""
"This experiment shows that IPsec <emphasis>does</emphasis> seem to be "
"distributing the payload data <emphasis>uniformly</emphasis>, as encryption "
"should. However, the experiment described here <emphasis>cannot</emphasis> "
"detect many possible flaws in a system (none of which do I have any evidence "
"for). These include poor key generation or exchange, data or keys being "
"visible to others, use of weak algorithms, kernel subversion, etc. Study the "
"source; know the code."
msgstr ""
"این آزمایش نشان می‌دهد که IPsec ظاهرا دارد داده‌ها را <emphasis>به طور "
"یکنواخت</emphasis> <emphasis>توزیع می‌کند</emphasis>، همانطور که از یک "
"رمزنگاری انتظار می‌رود. با این حال، آزمایشی که در اینجا شرح آن رفت "
"<emphasis>نمی‌تواند</emphasis> هیچگونه نقص احتمالی را در سامانه تشخیص دهد (که "
"برای هیچکدام از آنها هیچ نشانه‌ای ندارم). این نقص‌ها می‌توانند چیزهایی مثل "
"تولید کلید ضعیف یا تبادل نادرست کلیدها، در معرض نمایش بودن کلیدها یا داده‌ها "
"برای بقیه، استفاده از الگوریتم ضعیف، تخریب هسته از درون و غیره باشند. کدمنبع "
"را بخوانید و با آن آشنا شوید."

#. (itstool) path: sect1/title
#: article.translate.xml:171
msgid "IPsec---Definition"
msgstr "IPsec---تعریف"

#. (itstool) path: sect1/para
#: article.translate.xml:173
msgid ""
"Internet Protocol security extensions to IPv4; required for IPv6. A protocol "
"for negotiating encryption and authentication at the IP (host-to-host) "
"level. SSL secures only one application socket; <application>SSH</"
"application> secures only a login; <application>PGP</application> secures "
"only a specified file or message. IPsec encrypts everything between two "
"hosts."
msgstr ""
"افزونه‌های امنیتی قرارداد اینترنت برای IPv4؛ که در IPv6 الزامی است، قراردادی "
"است برای مذاکره کردن روش‌های رمزنگاری و احراز هویت در لایه IP (میزبان به "
"میزبان). SSL تنها یک سوکت را ایمن می‌کند؛ <application>SSH</application> تنها "
"یک ورود را ایمن می‌کند؛ <application>PGP</application> تنها یک پرونده یا "
"پیغام را ایمن می‌کند. ولی IPsec همه چیز را بین دو میزبان ایمن می‌کند."

#. (itstool) path: sect1/title
#: article.translate.xml:182
msgid "Installing IPsec"
msgstr "نصب IPsec"

#. (itstool) path: sect1/para
#: article.translate.xml:184
msgid ""
"Most of the modern versions of FreeBSD have IPsec support in their base "
"source. So you will need to include the <option>IPSEC</option> option in "
"your kernel config and, after kernel rebuild and reinstall, configure IPsec "
"connections using <citerefentry><refentrytitle>setkey</"
"refentrytitle><manvolnum>8</manvolnum></citerefentry> command."
msgstr ""
"بیشتر نسخه‌های مدرن FreeBSD از IPsec در کدمنبع‌شان پشتیبانی می‌کنند. تنها نیاز "
"است که شما گزینه <option>IPSEC</option> را در فایل پیکربندی هسته بگنجانید و "
"پس از آنکه هسته را کامپایل و نصب کردید، با استفاده از دستور "
"<citerefentry><refentrytitle>setkey</refentrytitle><manvolnum>8</manvolnum></"
"citerefentry> اتصالات IPsec را پیکربندی کنید."

#. (itstool) path: sect1/para
#: article.translate.xml:190
msgid ""
"A comprehensive guide on running IPsec on FreeBSD is provided in <link xlink:"
"href=\"@@URL_RELPREFIX@@/doc/en_US.ISO8859-1/books/handbook/ipsec.html"
"\">FreeBSD Handbook</link>."
msgstr ""
"یک راهنمای جامع درباره راه‌اندازی IPsec در FreeBSD در <link xlink:href="
"\"@@URL_RELPREFIX@@/doc/en_US.ISO8859-1/books/handbook/ipsec.html\">کتاب "
"راهنمای FreeBSD</link> آورده شده است."

#. (itstool) path: sect1/title
#: article.translate.xml:196
msgid "src/sys/i386/conf/KERNELNAME"
msgstr "src/sys/i386/conf/KERNELNAME"

#. (itstool) path: sect1/para
#: article.translate.xml:198
msgid ""
"This needs to be present in the kernel config file in order to capture "
"network data with <citerefentry><refentrytitle>tcpdump</"
"refentrytitle><manvolnum>1</manvolnum></citerefentry>. Be sure to run "
"<citerefentry><refentrytitle>config</refentrytitle><manvolnum>8</manvolnum></"
"citerefentry> after adding this, and rebuild and reinstall."
msgstr ""
"نیاز است تا آن را در فایل پیکربندی هسته گنجانده باشید تا بتوان داده‌های شبکه "
"را با <citerefentry><refentrytitle>tcpdump</refentrytitle><manvolnum>1</"
"manvolnum></citerefentry> ضبط کرد. مطمئن شوید که پس از اضافه کردن آن "
"<citerefentry><refentrytitle>config</refentrytitle><manvolnum>8</manvolnum></"
"citerefentry> را اجرا خواهید کرد، سپس هسته را مجددا کامپایل و نصب نمایید."

#. (itstool) path: sect1/programlisting
#: article.translate.xml:203
#, no-wrap
msgid "device\tbpf"
msgstr "device\tbpf"

#. (itstool) path: sect1/title
#: article.translate.xml:207
msgid "Maurer's Universal Statistical Test (for block size=8 bits)"
msgstr "Maurer's Universal Statistical Test (برای بلاک‌هایی با اندازه ۸ بیتی)"

#. (itstool) path: sect1/para
#: article.translate.xml:210
msgid ""
"You can find the same code at <link xlink:href=\"https://web.archive.org/"
"web/20031204230654/http://www.geocities.com:80/SiliconValley/Code/4704/"
"uliscanc.txt\"> this link</link>."
msgstr ""
"همین کد را می‌توانید در <link xlink:href=\"https://web.archive.org/"
"web/20031204230654/http://www.geocities.com:80/SiliconValley/Code/4704/"
"uliscanc.txt\"> این نشانی</link> هم پیدا کنید."

#. (itstool) path: sect1/programlisting
#: article.translate.xml:213
#, no-wrap
msgid ""
"/*\n"
"  ULISCAN.c   ---blocksize of 8\n"
"\n"
"  1 Oct 98\n"
"  1 Dec 98\n"
"  21 Dec 98       uliscan.c derived from ueli8.c\n"
"\n"
"  This version has // comments removed for Sun cc\n"
"\n"
"  This implements Ueli M Maurer's \"Universal Statistical Test for Random\n"
"  Bit Generators\" using L=8\n"
"\n"
"  Accepts a filename on the command line; writes its results, with other\n"
"  info, to stdout.\n"
"\n"
"  Handles input file exhaustion gracefully.\n"
"\n"
"  Ref: J. Cryptology v 5 no 2, 1992 pp 89-105\n"
"  also on the web somewhere, which is where I found it.\n"
"\n"
"  -David Honig\n"
"  honig@sprynet.com\n"
"\n"
"  Usage:\n"
"  ULISCAN filename\n"
"  outputs to stdout\n"
"*/\n"
"\n"
"#define L 8\n"
"#define V (1&lt;&lt;L)\n"
"#define Q (10*V)\n"
"#define K (100   *Q)\n"
"#define MAXSAMP (Q + K)\n"
"\n"
"#include &lt;stdio.h&gt;\n"
"#include &lt;math.h&gt;\n"
"\n"
"int main(argc, argv)\n"
"int argc;\n"
"char **argv;\n"
"{\n"
"  FILE *fptr;\n"
"  int i,j;\n"
"  int b, c;\n"
"  int table[V];\n"
"  double sum = 0.0;\n"
"  int iproduct = 1;\n"
"  int run;\n"
"\n"
"  extern double   log(/* double x */);\n"
"\n"
"  printf(\"Uliscan 21 Dec 98 \\nL=%d %d %d \\n\", L, V, MAXSAMP);\n"
"\n"
"  if (argc &lt; 2) {\n"
"    printf(\"Usage: Uliscan filename\\n\");\n"
"    exit(-1);\n"
"  } else {\n"
"    printf(\"Measuring file %s\\n\", argv[1]);\n"
"  }\n"
"\n"
"  fptr = fopen(argv[1],\"rb\");\n"
"\n"
"  if (fptr == NULL) {\n"
"    printf(\"Can't find %s\\n\", argv[1]);\n"
"    exit(-1);\n"
"  }\n"
"\n"
"  for (i = 0; i &lt; V; i++) {\n"
"    table[i] = 0;\n"
"  }\n"
"\n"
"  for (i = 0; i &lt; Q; i++) {\n"
"    b = fgetc(fptr);\n"
"    table[b] = i;\n"
"  }\n"
"\n"
"  printf(\"Init done\\n\");\n"
"\n"
"  printf(\"Expected value for L=8 is 7.1836656\\n\");\n"
"\n"
"  run = 1;\n"
"\n"
"  while (run) {\n"
"    sum = 0.0;\n"
"    iproduct = 1;\n"
"\n"
"    if (run)\n"
"      for (i = Q; run &amp;&amp; i &lt; Q + K; i++) {\n"
"        j = i;\n"
"        b = fgetc(fptr);\n"
"\n"
"        if (b &lt; 0)\n"
"          run = 0;\n"
"\n"
"        if (run) {\n"
"          if (table[b] &gt; j)\n"
"            j += K;\n"
"\n"
"          sum += log((double)(j-table[b]));\n"
"\n"
"          table[b] = i;\n"
"        }\n"
"      }\n"
"\n"
"    if (!run)\n"
"      printf(\"Premature end of file; read %d blocks.\\n\", i - Q);\n"
"\n"
"    sum = (sum/((double)(i - Q))) /  log(2.0);\n"
"    printf(\"%4.4f \", sum);\n"
"\n"
"    for (i = 0; i &lt; (int)(sum*8.0 + 0.50); i++)\n"
"      printf(\"-\");\n"
"\n"
"    printf(\"\\n\");\n"
"\n"
"    /* refill initial table */\n"
"    if (0) {\n"
"      for (i = 0; i &lt; Q; i++) {\n"
"        b = fgetc(fptr);\n"
"        if (b &lt; 0) {\n"
"          run = 0;\n"
"        } else {\n"
"          table[b] = i;\n"
"        }\n"
"      }\n"
"    }\n"
"  }\n"
"}"
msgstr ""
"/*\n"
"  ULISCAN.c   ---blocksize of 8\n"
"\n"
"  1 Oct 98\n"
"  1 Dec 98\n"
"  21 Dec 98       uliscan.c derived from ueli8.c\n"
"\n"
"  This version has // comments removed for Sun cc\n"
"\n"
"  This implements Ueli M Maurer's \"Universal Statistical Test for Random\n"
"  Bit Generators\" using L=8\n"
"\n"
"  Accepts a filename on the command line; writes its results, with other\n"
"  info, to stdout.\n"
"\n"
"  Handles input file exhaustion gracefully.\n"
"\n"
"  Ref: J. Cryptology v 5 no 2, 1992 pp 89-105\n"
"  also on the web somewhere, which is where I found it.\n"
"\n"
"  -David Honig\n"
"  honig@sprynet.com\n"
"\n"
"  Usage:\n"
"  ULISCAN filename\n"
"  outputs to stdout\n"
"*/\n"
"\n"
"#define L 8\n"
"#define V (1&lt;&lt;L)\n"
"#define Q (10*V)\n"
"#define K (100   *Q)\n"
"#define MAXSAMP (Q + K)\n"
"\n"
"#include &lt;stdio.h&gt;\n"
"#include &lt;math.h&gt;\n"
"\n"
"int main(argc, argv)\n"
"int argc;\n"
"char **argv;\n"
"{\n"
"  FILE *fptr;\n"
"  int i,j;\n"
"  int b, c;\n"
"  int table[V];\n"
"  double sum = 0.0;\n"
"  int iproduct = 1;\n"
"  int run;\n"
"\n"
"  extern double   log(/* double x */);\n"
"\n"
"  printf(\"Uliscan 21 Dec 98 \\nL=%d %d %d \\n\", L, V, MAXSAMP);\n"
"\n"
"  if (argc &lt; 2) {\n"
"    printf(\"Usage: Uliscan filename\\n\");\n"
"    exit(-1);\n"
"  } else {\n"
"    printf(\"Measuring file %s\\n\", argv[1]);\n"
"  }\n"
"\n"
"  fptr = fopen(argv[1],\"rb\");\n"
"\n"
"  if (fptr == NULL) {\n"
"    printf(\"Can't find %s\\n\", argv[1]);\n"
"    exit(-1);\n"
"  }\n"
"\n"
"  for (i = 0; i &lt; V; i++) {\n"
"    table[i] = 0;\n"
"  }\n"
"\n"
"  for (i = 0; i &lt; Q; i++) {\n"
"    b = fgetc(fptr);\n"
"    table[b] = i;\n"
"  }\n"
"\n"
"  printf(\"Init done\\n\");\n"
"\n"
"  printf(\"Expected value for L=8 is 7.1836656\\n\");\n"
"\n"
"  run = 1;\n"
"\n"
"  while (run) {\n"
"    sum = 0.0;\n"
"    iproduct = 1;\n"
"\n"
"    if (run)\n"
"      for (i = Q; run &amp;&amp; i &lt; Q + K; i++) {\n"
"        j = i;\n"
"        b = fgetc(fptr);\n"
"\n"
"        if (b &lt; 0)\n"
"          run = 0;\n"
"\n"
"        if (run) {\n"
"          if (table[b] &gt; j)\n"
"            j += K;\n"
"\n"
"          sum += log((double)(j-table[b]));\n"
"\n"
"          table[b] = i;\n"
"        }\n"
"      }\n"
"\n"
"    if (!run)\n"
"      printf(\"Premature end of file; read %d blocks.\\n\", i - Q);\n"
"\n"
"    sum = (sum/((double)(i - Q))) /  log(2.0);\n"
"    printf(\"%4.4f \", sum);\n"
"\n"
"    for (i = 0; i &lt; (int)(sum*8.0 + 0.50); i++)\n"
"      printf(\"-\");\n"
"\n"
"    printf(\"\\n\");\n"
"\n"
"    /* refill initial table */\n"
"    if (0) {\n"
"      for (i = 0; i &lt; Q; i++) {\n"
"        b = fgetc(fptr);\n"
"        if (b &lt; 0) {\n"
"          run = 0;\n"
"        } else {\n"
"          table[b] = i;\n"
"        }\n"
"      }\n"
"    }\n"
"  }\n"
"}"
